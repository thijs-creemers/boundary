@startuml
!include https://raw.githubusercontent.com/plantuml-stdlib/C4-PlantUML/master/C4_Container.puml

LAYOUT_WITH_LEGEND()

title Container Diagram for Boundary Framework

Person(api_user, "API Consumer", "External system or developer consuming REST endpoints")
Person(cli_user, "Operator", "System administrator using CLI for management tasks")  
Person(web_user, "End User", "Business user interacting via web interface")

System_Boundary(boundary, "Boundary Framework") {
    Container(web_app, "Web Application", "ClojureScript, Replicant", "Interactive web interface for user management")
    Container(api_app, "REST API", "Ring, Reitit", "JSON API for system integration")
    Container(cli_app, "CLI Tool", "tools.cli", "Command-line interface for operations")
    
    Container(core, "Functional Core", "Pure Clojure", "Business logic and domain rules")
    Container(shell, "Imperative Shell", "Clojure", "Validation, I/O, and side effects")
}

System_Ext(database, "PostgreSQL", "Persistent data storage")
System_Ext(email, "Email Service", "SMTP server for notifications")

Rel(api_user, api_app, "Makes API calls", "HTTPS/JSON")
Rel(cli_user, cli_app, "Executes commands", "CLI")
Rel(web_user, web_app, "Uses", "HTTPS")

Rel(api_app, shell, "Validates input, handles I/O")
Rel(cli_app, shell, "Validates input, handles I/O")  
Rel(web_app, shell, "Validates input, handles I/O")

Rel(shell, core, "Calls pure functions", "Immutable data")
Rel(shell, database, "Reads/writes data", "SQL")
Rel(shell, email, "Sends notifications", "SMTP")

SHOW_LEGEND()

@enduml
