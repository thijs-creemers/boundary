;; Monorepo Root deps.edn
;; 
;; This configuration supports development across all Boundary libraries.
;; Individual libraries have their own deps.edn files in libs/*/deps.edn
;;
;; For production use, depend on individual published libraries:
;;   {:deps {boundary/platform {:mvn/version "0.1.0"}}}

{:paths []  ;; No paths at root - libraries define their own paths
 
 :deps {org.clojure/clojure {:mvn/version "1.12.4"}}
 
 :aliases
 {;; =============================================================================
  ;; Development - All libraries loaded for cross-library development
  ;; =============================================================================
  
  :dev {:extra-paths ["libs/core/src"
                      "libs/observability/src"
                      "libs/platform/src"
                      "libs/user/src"
                      "libs/admin/src"
                      "libs/storage/src"
                      "libs/external/src"
                      "libs/scaffolder/src"
                      "resources"
                      "dev"]
        :extra-deps {;; All library dependencies (merged for dev)
                     ;; Core
                     metosin/malli {:mvn/version "0.20.0"}
                     
                     ;; Observability
                     org.clojure/tools.logging {:mvn/version "1.3.1"}
                     ch.qos.logback/logback-classic {:mvn/version "1.5.23"}
                     io.sentry/sentry-clj {:mvn/version "8.29.238"}
                     
                     ;; Platform - Database
                     com.github.seancorfield/next.jdbc {:mvn/version "1.3.1086"}
                     com.github.seancorfield/honeysql {:mvn/version "2.7.1364"}
                     com.zaxxer/HikariCP {:mvn/version "7.0.2"}
                     migratus/migratus {:mvn/version "1.6.4"}
                     
                     ;; Platform - HTTP
                     ring/ring-core {:mvn/version "1.15.3"}
                     ring/ring-jetty-adapter {:mvn/version "1.15.3"}
                     ring/ring-anti-forgery {:mvn/version "1.4.0"}
                     metosin/reitit-ring {:mvn/version "0.9.2"}
                     metosin/reitit-malli {:mvn/version "0.9.2"}
                     metosin/reitit-middleware {:mvn/version "0.9.2"}
                     metosin/reitit-swagger {:mvn/version "0.9.2"}
                     metosin/reitit-swagger-ui {:mvn/version "0.9.2"}
                     metosin/muuntaja {:mvn/version "0.6.11"}
                     
                     ;; Platform - Configuration
                     integrant/integrant {:mvn/version "1.0.1"}
                     integrant/repl {:mvn/version "0.5.0"}
                     aero/aero {:mvn/version "1.1.6"}
                     environ/environ {:mvn/version "1.2.0"}
                     com.lambdaisland/dotenv {:mvn/version "0.2.5"}
                     
                     ;; Platform - JSON
                     cheshire/cheshire {:mvn/version "6.1.0"}
                     
                     ;; User - Authentication
                     buddy/buddy-hashers {:mvn/version "2.0.167"}
                     buddy/buddy-sign {:mvn/version "3.6.1-359"}
                     one-time/one-time {:mvn/version "0.8.0"
                                        :exclusions [com.github.kenglxn.qrgen/javase]}
                     
                     ;; UI
                     hiccup/hiccup {:mvn/version "2.0.0"}
                     
                     ;; Storage - S3
                     software.amazon.awssdk/s3 {:mvn/version "2.39.5"}
                     software.amazon.awssdk/s3-transfer-manager {:mvn/version "2.39.5"}
                     
                     ;; Scaffolder
                     org.clojure/tools.cli {:mvn/version "1.3.250"}
                     
                     ;; Database drivers for development
                     org.xerial/sqlite-jdbc {:mvn/version "3.51.0.0"}
                     org.postgresql/postgresql {:mvn/version "42.7.8"}
                     com.h2database/h2 {:mvn/version "2.4.240"}
                     com.mysql/mysql-connector-j {:mvn/version "9.5.0"}
                     
                     ;; Development tools
                     nrepl/nrepl {:mvn/version "1.5.1"}
                     cider/cider-nrepl {:mvn/version "0.58.0"}}
        :jvm-opts ["-Denv=dev"]}
  
  ;; =============================================================================
  ;; Testing - All library test paths
  ;; =============================================================================
  
  :test {:extra-paths ["libs/core/test"
                       "libs/observability/test"
                       "libs/platform/test"
                       "libs/user/test"
                       "libs/admin/test"
                       "libs/storage/test"
                       "libs/external/test"
                       "libs/scaffolder/test"]
         :extra-deps {lambdaisland/kaocha {:mvn/version "1.91.1392"}
                      org.clojure/test.check {:mvn/version "1.1.2"}
                      com.gfredericks/test.chuck {:mvn/version "0.2.15"}}
         :main-opts ["-m" "kaocha.runner"]
         :jvm-opts ["-Denv=test"]}
  
  ;; Test individual libraries
  :test:core {:extra-paths ["libs/core/src" "libs/core/test"]
              :extra-deps {lambdaisland/kaocha {:mvn/version "1.91.1392"}
                           metosin/malli {:mvn/version "0.20.0"}}
              :main-opts ["-m" "kaocha.runner"]
              :jvm-opts ["-Denv=test"]}
  
  :test:observability {:extra-paths ["libs/core/src" "libs/observability/src" 
                                      "libs/core/test" "libs/observability/test"]
                       :extra-deps {lambdaisland/kaocha {:mvn/version "1.91.1392"}}
                       :main-opts ["-m" "kaocha.runner"]
                       :jvm-opts ["-Denv=test"]}
  
  :test:platform {:extra-paths ["libs/core/src" "libs/observability/src" "libs/platform/src"
                                 "libs/core/test" "libs/observability/test" "libs/platform/test"]
                  :extra-deps {lambdaisland/kaocha {:mvn/version "1.91.1392"}
                               com.h2database/h2 {:mvn/version "2.4.240"}}
                  :main-opts ["-m" "kaocha.runner"]
                  :jvm-opts ["-Denv=test"]}
  
  ;; =============================================================================
  ;; REPL
  ;; =============================================================================
  
  :repl-clj {:extra-paths ["dev"]
             :main-opts ["-m" "nrepl.cmdline" "--port" "7888" 
                         "--middleware" "[cider.nrepl/cider-middleware]"]}
  
  :repl-cljs {:extra-deps {org.clojure/clojurescript {:mvn/version "1.12.116"}
                           cider/piggieback {:mvn/version "0.6.1"}}
              :main-opts ["-m" "nrepl.cmdline" "--middleware"
                          "[cider.nrepl/cider-middleware,cider.piggieback/wrap-cljs-repl]"]}
  
  ;; =============================================================================
  ;; Database drivers (for specific database testing)
  ;; =============================================================================
  
  :db {:extra-deps {org.xerial/sqlite-jdbc {:mvn/version "3.51.0.0"}
                    org.postgresql/postgresql {:mvn/version "42.7.8"}
                    com.h2database/h2 {:mvn/version "2.4.240"}
                    com.mysql/mysql-connector-j {:mvn/version "9.5.0"}}}
  
  :db/h2 {:extra-deps {com.h2database/h2 {:mvn/version "2.4.240"}}}
  
  :db/sqlite {:extra-deps {org.xerial/sqlite-jdbc {:mvn/version "3.51.0.0"}}}
  
  :db/postgresql {:extra-deps {org.postgresql/postgresql {:mvn/version "42.7.8"}}}
  
  :db/mysql {:extra-deps {com.mysql/mysql-connector-j {:mvn/version "9.5.0"}}}
  
  ;; =============================================================================
  ;; Code quality tools
  ;; =============================================================================
  
  :clj-kondo {:replace-deps {clj-kondo/clj-kondo {:mvn/version "2025.10.23"}}
              :main-opts ["-m" "clj-kondo.main"]}
  
  :cljfmt {:extra-deps {lein-cljfmt/lein-cljfmt {:mvn/version "0.9.2"}}
           :main-opts ["-m" "cljfmt.main"]}
  
  :outdated {:extra-deps {olical/depot {:mvn/version "2.4.1"}}
             :main-opts ["-m" "depot.outdated.main"]}
  
  :coverage {:extra-deps {cloverage/cloverage {:mvn/version "1.2.4"}}
             :main-opts ["-m" "cloverage.coverage"
                         "--src-ns-path" "libs/*/src"
                         "--test-ns-path" "libs/*/test"
                         "--text"]
             :jvm-opts ["-Denv=test"]}
  
  ;; =============================================================================
  ;; Build tooling
  ;; =============================================================================
  
  :build {:extra-paths ["tools"]
          :extra-deps {io.github.clojure/tools.build {:git/tag "v0.10.11" :git/sha "c6c670a4"}}
          :ns-default build}
  
  ;; =============================================================================
  ;; Migrations
  ;; =============================================================================
  
  :migrate {:main-opts ["-m" "boundary.platform.shell.database.cli-migrations"]
            :jvm-opts ["-Denv=dev"]}
  
  ;; =============================================================================
  ;; CLI Interface
  ;; =============================================================================
  
  :cli {:main-opts ["-m" "boundary.cli"]
        :jvm-opts ["-Denv=dev"]}}}
